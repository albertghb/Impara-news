"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1395],{25763:function(t,e,n){n.d(e,{Xq:function(){return o},_R:function(){return i},dv:function(){return a}});var r=n(87636);let a=t=>async()=>{try{return(await t.get("cart")).data}catch(t){throw Error(t.message)}},o=t=>async e=>{try{await t.post("cart",e)}catch(t){(0,r.S3)(t)}},i=t=>async e=>{try{return(await t.post("cart/checkout",e)).data}catch(t){throw Error(t.message)}}},59706:function(t,e,n){n.d(e,{SU:function(){return o},Tg:function(){return i},U_:function(){return u}});var r=n(83109),a=n(87636);let o=t=>async function(e,n){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;try{return(await t.get("licences/".concat(e,"?lan=").concat(n,"&isSimplifiedPricingFeatureEnabled=").concat(o,"&isVideo=").concat(i),{...r?{}:{validateStatus:null}})).data}catch(t){return(0,a.S3)(t),{rf:null,standard:[],pack:null}}},i=t=>async function(e,n,o,i){let u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r.CurrencyCode.GBP,s=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,E=!(arguments.length>9)||void 0===arguments[9]||arguments[9];try{let r="ct-licences?query=".concat(e,"&renditions=").concat(n,"&locale=").concat(o,"&cacheKey=").concat(i,"&licenseType=").concat(l,"&ebm=").concat(u,"&currency=").concat(c,"&collectionId=").concat(s);return d&&(r+="&storeKey=".concat(d)),(await t.get(r,{...E?{}:{validateStatus:null}})).data}catch(t){return(0,a.S3)(t),{rf:null,standard:[],pack:null}}},u=t=>async e=>{try{return(await t.post("purchase",e)).data}catch(t){throw Error(t.message)}}},19473:function(t,e,n){n.d(e,{RK:function(){return r},Rg:function(){return o},S7:function(){return a}});let r=t=>async()=>{try{return(await t.get("lightboxes")).data.items}catch(t){throw Error(t.message)}},a=t=>async(e,n)=>{try{return(await t.post("lightboxes/".concat(e.id),{seq:n.altids.seq,productType:n.type})).data}catch(t){throw Error(t.message)}},o=t=>async(e,n)=>{try{return(await t.post("lightboxes",{name:e,seq:n.altids.seq,productType:n.type})).data}catch(t){throw Error(t.message)}}},11237:function(t,e,n){var r,a;n.d(e,{M:function(){return r}}),(a=r||(r={})).MAIN="main",a.DOWNLOAD="download",a.BUY_NOW="buyNow"},34051:function(t,e,n){var r,a,o,i;n.d(e,{C:function(){return r},q:function(){return a}}),(o=r||(r={})).APPLY_LICENSE="APPLY_LICENSE",o.RESTRICT_LIFT_REQUEST="RESTRICT_LIFT_REQUEST",o.DUPLICATE="DUPLICATE",o.DELETE="DELETE",o.HELP="HELP",o.DEFAULT="DEFAULT",o.APPROVE_REQUEST="APPROVE_REQUEST",o.DENY_REQUEST="DENY REQUEST",(i=a||(a={})).ADD_LINE_ITEM="addLineItem",i.REMOVE_LINE_ITEM="removeLineItem",i.RESTRICT_LIFT_REQUEST="alamy_restrictionsLiftRequest",i.HELP="alamy_cartCustomerNotification",i.DUPLICATE="alamy_duplicateRequest",i.APPROVE_REQUEST="alamy_approveRequests",i.DENY="alamy_denyRequests",i.APPLY_LICENSE="alamy_applyLicense"},82294:function(t,e,n){n.d(e,{GQ:function(){return v},Hh:function(){return f},MR:function(){return h},Tx:function(){return d},dv:function(){return s},js:function(){return T},rc:function(){return y},yY:function(){return R}});var r=n(45429),a=n(65885),o=n(55406),i=n(11237),u=n(34051),l=n(39208),c=n(3685);let s=async(t,e)=>{let n=Object.entries((null==e?void 0:e.getAll())||{}).map(t=>{let[e,n]=t;return"".concat(e,"=").concat(n)}).join("; "),r=await (0,l.dL)();return(await r.post("cart/".concat(t),{},{headers:{"Content-Type":"application/json",...n&&{Cookie:n}}})).data||[]},d=async t=>{let{selections:e=[],productId:n,variantId:s,addedAt:d=Date.now(),isPremium:E=!1,version:p,type:v,comment:h,duplicateCount:y}=t;try{let t=await (0,l.dL)(),R=[];if(v===u.C.DELETE&&R.push(...e.map(t=>{let{lineItemId:e}=t;return{action:u.q.REMOVE_LINE_ITEM,lineItemId:e}})),v===u.C.APPLY_LICENSE){let{commercetoolsConfig:t}=(0,o.b)(),i=E&&t?await (0,r.cS)(t):void 0;R.push(...e.map(t=>{var e,o;let{alamy_assetId:l,alamy_assetSeq:E,alamy_assetRef:p,assetType:v,lineItemId:h}=t;return{action:u.q.APPLY_LICENSE,lineItemId:h,...(0,r.$C)({productId:n,variantId:s,assetId:l,assetSeq:E,assetRef:p,addedAt:d,channelId:null==i?void 0:i.id,assetType:v,channelKeyWithAsset:(e=new a.Z(document.cookie),null!==(o=void 0===e?void 0:e.get(c.YA))&&void 0!==o)?o:null})}}))}else[u.C.RESTRICT_LIFT_REQUEST,u.C.HELP].includes(v)?R.push({action:v===u.C.HELP?u.q.HELP:u.q.RESTRICT_LIFT_REQUEST,assets:e.map(t=>{let{alamy_assetRef:e}=t;return e}),comments:h}):v===u.C.DUPLICATE?R.push({action:u.q.DUPLICATE,lineItems:e.map(t=>{let{lineItemId:e}=t;return{id:e,count:y||1}})}):[u.C.DENY_REQUEST,u.C.APPROVE_REQUEST].includes(v)&&R.push({action:v===u.C.APPROVE_REQUEST?u.q.APPROVE_REQUEST:u.q.DENY,lineItems:e.map(t=>{let{lineItemId:e}=t;return e})});let f=await t.post("cart/".concat(i.M.DOWNLOAD),{version:p,actions:R});return(null==f?void 0:f.data)||[]}catch(t){return t.message}},[E,p]=["hd","4k"],v=t=>{let e=null==t?void 0:t.every(t=>{var e;return null===(e=t.assetSubType)||void 0===e?void 0:e.some(t=>t.toLowerCase().includes(p))}),n=null==t?void 0:t.every(t=>{var e;return null===(e=t.assetSubType)||void 0===e?void 0:e.some(t=>t.toLowerCase().includes(E)&&!t.toLowerCase().includes(p))});return e&&n?[E,p]:n?[E]:e?[p]:[]},h=t=>{let e=[];return t.forEach(t=>{t.toLowerCase().includes(E)&&!t.toLowerCase().includes(p)?e.push(E.toUpperCase()):t.toLowerCase().includes(p)&&e.push(p.toUpperCase())}),e},y=t=>{var e,n,r,a;let o=null!==(e=null==t?void 0:t.every(t=>{let{licenseType:e}=t;return"RM"===e}))&&void 0!==e&&e,i=null!==(n=null==t?void 0:t.every(t=>{let{licenseType:e}=t;return"RF"===e}))&&void 0!==n&&n,u=null!==(r=null==t?void 0:t.some(t=>{let{licenseType:e}=t;return"RM"===e}))&&void 0!==r&&r&&null!==(a=null==t?void 0:t.some(t=>{let{licenseType:e}=t;return"RF"===e}))&&void 0!==a&&a;return{hide:i||u,disable:o||u}},R=t=>{let e=new Set,n=new Set;return null==t||t.forEach(t=>{var r,a;let{custom:o}=t;return(n.has(null==o?void 0:null===(r=o.fields)||void 0===r?void 0:r.alamy_assetRef)?e:n).add(null==o?void 0:null===(a=o.fields)||void 0===a?void 0:a.alamy_assetRef)}),Array.from(e)},f=t=>(null==t?void 0:t.startsWith("pending:"))&&Number(t.slice(8))||null,T=(t,e)=>{let n=[],r=[];return t.forEach(t=>{(null==e?void 0:e.some(e=>e.assetId===t.alamy_assetId&&"approved"!==t.restrictionRemoveReq&&(71===e.assetStatus||e.geoRestricted)))?n.push(t):r.push(t)}),{isRestricted:n.length>0,restrictedItems:n,unRestrictedItems:r}}},71395:function(t,e,n){n.d(e,{um:function(){return C},aD:function(){return w},x2:function(){return L}});var r=n(83109),a=n(25501),o=n(58656),i=n(89685),u=n(91817),l=n(25763),c=n(59706),s=n(19473),d=n(70680),E=n(11237),p=n(39208),v=n(12449),h=n(82294),y=n(40058),R=n(82165),f=n(35353);let T=t=>{let{addContext:e,getInitialProps:n,getFinalProps:r}=t;return t=>{let a=async a=>{let o=await e(a),i={...a,...o},u=await n(i);if("redirect"in u||"notFound"in u)return u;let l=u.props,c=await t({...i,initialProps:l});if("redirect"in c||"notFound"in c)return c;let s=await r({...i,initialProps:l});return"redirect"in s||"notFound"in s?s:{props:{...u.props,...c.props,...s.props}}};return a.inner=t,a}},m=(t,e)=>Promise.resolve({props:{pageData:{layoutData:{currency:r.CurrencyCode.GBP,countryCode:null,contactNumber:"",imageCount:0,isDefaultData:!0},authInfo:t,lightboxes:[],cart:{count:0},licences:null,cookieDomain:e}}}),C=async(t,e,n,r,a,o,u,p)=>{var v;let R=(0,y.Z)(r,e.user,i.y.PageData,u),[f,T,m,C,L]=await Promise.all([(0,d.r)(t)(),n?(0,s.RK)(t)():[],n&&!R?(0,l.dv)(t)():{count:0},n&&(null==e?void 0:null===(v=e.user)||void 0===v?void 0:v.isIQUser)&&!R?(0,c.SU)(t)(1,r):null,n&&!p&&o&&R?(0,h.dv)(E.M.MAIN,u):null]);return{props:{pageData:{layoutData:f,authInfo:e,lightboxes:T,cart:m,licences:C,cookieDomain:a,ppmInitialCart:L||null}}}},L=T({addContext:async t=>{let{req:e,res:n,locale:r}=t,i=new a.Z(e.headers.cookie),l=(0,R.QR)(e.headers.host||""),c=await (0,p.yx)(i,e),s=await (0,p.yx)(i,e,!0),d=(null==e?void 0:e.headers["x-distributor-territory"])?o.a:r||o.a,E=e.headers["user-agent"]||"",h=(0,f.CA)(E),y=!!(0,v.b)(i),T=await (0,u.yr)(c)(i,n,d,l,h),{referer:m}=e.headers,C=null==i?void 0:i.get("ctToken");return{cookies:i,api:c,locale:d,isBot:h,authInfo:T,isAuthenticatedRequest:y,cookieDomain:l,referer:m,ctToken:C,apiSearch:s}},getInitialProps:t=>{let{authInfo:e,cookieDomain:n}=t;return m(e,n)},getFinalProps:t=>{let{cookies:e}=t;return Promise.resolve({props:{cookie:(0,R.SQ)(e)}})}}),w=T({addContext:async t=>{let{req:e,res:n,locale:r}=t,i=new a.Z(e.headers.cookie),l=(0,R.QR)(e.headers.host||""),c=await (0,p.yx)(i,e),s=await (0,p.yx)(i,e,!0),d=r||o.a,E=e.headers["user-agent"]||"",h=(0,f.CA)(E),y=(0,v.b)(i),T=await (0,u.yr)(c)(i,n,d,l,h),{referer:m}=e.headers,C=null==i?void 0:i.get("ctToken");return{cookies:i,api:c,locale:d,isBot:h,authInfo:T,isAuthenticatedRequest:!!y,cookieDomain:l,referer:m,ctToken:C,apiSearch:s}},getInitialProps:t=>{let{api:e,authInfo:n,isAuthenticatedRequest:r,locale:a,cookieDomain:o,ctToken:i,cookies:u}=t;return C(e,n,r,a,o,i,u)},getFinalProps:t=>{let{cookies:e}=t;return Promise.resolve({props:{cookie:(0,R.SQ)(e)}})}})}}]);